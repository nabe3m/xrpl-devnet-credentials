# XRPL Credentials サンプル

このプロジェクトは、XRPLのDevnet環境でCredentials機能を試すためのサンプル実装です。

Credentials機能は、XRPLにおいてブロックチェーン上で証明書や資格情報を発行・管理するための機能を提供します。

## セットアップ

1. リポジトリのクローンとディレクトリの移動:
```bash
git clone https://github.com/nabe3m/xrpl-devnet-credentials.git
cd xrpl-devnet-credentials
```

2. 依存関係のインストール:
```bash
npm install
```

3. 環境変数の設定:
`.env.example`ファイルを`.env`にコピーする方法:

```bash
cp .env.example .env
```

## 使用方法

### 1. アカウントの作成
Devnet上に新しいXRPLアカウント（発行者と受信者）を作成し、`.env`ファイルを自動的に更新します:
```bash
npm run create-account
```

実行結果:
- 発行者アカウントのアドレスとシークレットが表示されます
- 受信者アカウントのアドレスとシークレットが表示されます
- `.env`ファイルが作成・更新され、両方のアカウント情報が保存されます
- Devnetフォーセットから各アカウントに100 XRPが入金されます

### 2. クレデンシャルの発行と確認
サンプルシナリオを実行してクレデンシャルを発行します:
```bash
npm run run-credential-example
```

実行結果:
- 認定機関（発行者）アカウントから受信者アカウントへクレデンシャルが発行されます
- 証明書のタイプ、詳細情報、有効期限などが設定されます
- トランザクションIDが表示され、`.env`ファイルを手動で更新すると後続のステップで使用できます

### 3. クレデンシャルの確認
発行されたクレデンシャルの詳細を確認します:
```bash
npm run view-credential
```

実行結果:
- 発行者が発行したすべてのクレデンシャル一覧が表示されます
- 受信者宛てのクレデンシャル一覧が表示されます
- クレデンシャルの承認状態、有効期限などの詳細情報が確認できます

### 4. クレデンシャルの承認
受信者がクレデンシャルを承認します:
```bash
npm run accept-credential
```

実行結果:
- 受信者アカウントがクレデンシャルを正式に承認します
- トランザクションハッシュが表示されます
- 承認後、クレデンシャルの`accepted`フラグが`true`に変更されます

### 5. クレデンシャルの取り消し
発行したクレデンシャルを取り消します:
```bash
npm run revoke-credential
```

実行結果:
- 取り消し対象のクレデンシャル情報が表示されます
- 確認プロンプトが表示され、`y`を入力すると取り消しが実行されます
- 取り消し後のクレデンシャル一覧が表示され、対象のクレデンシャルが削除されていることが確認できます

## 開発向けのコマンド

コードのフォーマット:
```bash
npm run format
```

リンターの実行:
```bash
npm run lint
```

## 注意事項

- このプロジェクトはDevnet環境向けの実装です
- Credentials機能は現在Devnetでのみ利用可能です（2025年4月現在）
- クレデンシャルの取り消しは発行者のみが実行できます
- 将来的に本番環境で使用する際は、適切なセキュリティ対策を講じてください

## XRPLとDevnet環境について

- Devnetは開発者がXRPLの新機能を安全にテストするための環境です
- テスト用XRPはDevnetフォーセットから無料で入手できます
- トランザクションの詳細はDevnet Explorerで確認できます: https://devnet.xrpl.org

## トラブルシューティング

- 接続エラーが発生した場合は、Devnetのステータスを確認してください
- アカウント作成後もトランザクションが失敗する場合は、残高が十分かを確認してください
- トランザクションが失敗する場合は、シークレットキーが正しいことを確認してください 
